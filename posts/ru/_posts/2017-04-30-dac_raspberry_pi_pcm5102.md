---
layout: post
lang: ru
ref: raspberry-dac
title: "Интернет-приемник: Подключение аудио ЦАП к raspberry pi"
comments: true
summary: ...Подключение аудио ЦАП к raspberry pi...
tags: [raspberry pi, DAC, HAT, PCM5102]
---

Если вы хотите сделать интернет-приемник, то самый простой вариант - взять raspberry pi, подключить к ней
ЦАП (цифро-аналоговый преобразователь, на ангийском DAC) и нравящуюся вам акустику.
Ну и поставить то приложение, которое вам нравится (volumio, rune audio, max2play etc).
Управлять им вы будете со своего телефона, т.е. на самом интернет-приемнике у вас не будет никаких
элементов управления и его вообще можно замуровать в фальш-потолок, например.

ЦАП нужен потому, что из разъема для наушников у raspberry pi звук вообще ниже любой критики, тут речь не об
аудиофилии, а просто чтобы уши не болели.

Вместо DAC можно использовать любой HDMI-Video/audio преобразователь (ищется на [aliexpress](https://www.aliexpress.com) по строке
"hdmi rca", коробочка, куда втыкается на вход HDMI и на выходе разъемы RCA "тюльпаны" - желтый видео
и белый/красный аудио). Вместе с нужным для него HDMI кабелем будет стоить примерно как и описываемые ЦАП, 
так что тут скорее дело вкуса, что использовать.
Конечно, с точки зрения программы это совершенно иной способ вывода звука (не управление ЦАП по I2S интерфейсу,
а вывод звука на HDMI), но для вас это просто переключатель в веб-интерфейсе volumio.

На фото вариант с выводом на RCA разъемы, это отличная альтернатива HiFiBerry, стоящей $35, 
на aliexpress она более чем в четыре раза дешевле:

![](/images/PCM5102-DAC-Decoder-I2S-Player.jpg)

Эта плата ровно на той же микросхеме, что и HiFiBerry, а обвязочных элементов там минимум, так что вряд ли 
китайское изделие чем-то хуже.

Второй вариант с выводом на разъем для наушников:

![](/images/Sound-Card-I2S-PCM5102.jpg)


Искать эти платы на [aliexpress](https://www.aliexpress.com) проще по строке "Raspberry Pi PCM5102".

Китайцы на них всех пишут что это HAT-платы, но это не совсем правда.
Они подключаются к HAT разъему raspberry pi но их нельзя просто вставить в него, как HiFiBerry.

В принципе паяльник не обязателен, если речь о первом варианте платы и новых raspberry pi (не zero) - тогда можно
соединить штырьки разъемов с помощью контактных проводов (если они у вас есть, конечно), найти такие провода на
[aliexpress](https://www.aliexpress.com) можно по строке "wires female to female dupont" - как правило, они цветные, на концах разъемчики
(вам нужен вариант female - female).

С подключением к raspberry pi есть одна особенность.
На самых ранних raspberry pi нужные контакты не выведены ни на какой разъем, но есть на плате и в интернете можно
тайти соответствующие схему.

Если у вас чуть более свежие, но все равно старые raspbery pi (до "+" версии), то нужные контакты находятся на 
разъеме P5, размещенном пониже основного разъема рсширение (P1), и на многих вариантах P5 не распаян.

Можете посмотреть видео, как его распаивать на сайте 
[HiFiBerry](https://www.hifiberry.com/solder-the-p5-header-to-your-raspberry-pi-model-ab/)

Подробнее о нем можно прочитать 
[Raspberry Pi P5 Header](http://www.raspberrypi-spy.co.uk/2012/09/raspberry-pi-p5-header/)

Обратите внимание, что разъем подразумевается к установке с обратной стороны платы (хотя в виде про HiFiBerry его паяют с той же стороны что и основной
разъем расширения)
Поэтому четные-нечетные в нем с противоположной стороны от того, как в основном разъеме.
Проверить себя, можно померив напряжение - на контакте P5-1 должно быть 5В, на контакте P5-2 3.3В (оба последних контакта, P5-7 и 8 - земля).

На более новых raspberry pi (с "+") а также на моделях raspberry pi 2 и 3, все нужные контакты
находятся на основном разъеме расширения (он теперь называется J8 и состоит из 26 контактов P1 старых
моделей и новых контактов, т.е. строго говрря того, что было на P5 в нем нет, но программно обеспечивается
совместимость, поэтому можно подключать ЦАП на старых моделях к P1 и P5, а на новых к J8).

## Как соединять контакты

### Первый вариант ЦАП:

| Vcc(+5v) | P5-1 / J8-2 |
| +3.3 (Не используется, для контроля нумерации контактов) | P5-2 / j8-1 |
| BCK | P5-3 / J8-12 |
| LRCK | P5-4 / J8-35 |
| DATA | P5-6 / J8-40 |
| Gnd | P5-7 / J8-39 |

В описании ЦАП китаец пишет, что на нам неверно обозначены BCK и DATA, но наверно это относится
к ранним модификациям платы - на моей крайний разъем обозначен BCK и так его и надо подключать.

### Второй вариант ЦАП: 

К первому варинту добавляются контакты

| GND |	P1-6 / J8-6 |
| FLT(gnd) | P1-14? / J8-14 |
| DMP(gnd) | P5-8 / J8-20 |
| SCL	| P1-5 / J8-5 |
| FMT	(gnd) | P1-14 / J8-14? |
| XMT(3.3v) | P1-1 / J8-1? |

Подробно разъемы для интересующихся расписаны на вики:
[RPi Low-level peripherals](http://elinux.org/RPi_Low-level_peripherals)


